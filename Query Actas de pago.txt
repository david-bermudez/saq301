SELECT DISTINCT A.ELEMENT_NO,
  A.ELEMENT_CODE,
  A.ELEMENT_VAL,
  B.CATEG_CODE
FROM ELLIPSE.MSF386 A
INNER JOIN ELLIPSE.MSF387 B
ON (A.CONTRACT_NO      = B.CONTRACT_NO
AND A.PORTION_NO       = B.PORTION_NO 
AND A.ELEMENT_NO       = B.ELEMENT_NO )
WHERE (A.CONTRACT_NO     = :AContract)
AND (A.PORTION_NO        = :APortion)
AND ( B.CATEG_CODE NOT IN ('VLPR','VLOT') )
ORDER BY A.ELEMENT_NO
